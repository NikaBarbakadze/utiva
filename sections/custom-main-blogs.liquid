{% liquid
    
    assign blog_tags = "Vaginal Health,UTIs,Overactive Bladder,Gut Health,Conditions 101,Video" | split: ","

%}

<style>
    .custom-blog-tag.active{
        opacity: 1;
        border-bottom: 1px solid #1C1C1C;
    }

    @media screen and (max-width: 992px){
        #tags-wrapper{
            overflow-x: scroll;
            width: 100%;
            max-width: 100vw;
            overflow-y: visible;
            flex-wrap: nowrap!important;
            scroll-snap-type: x var(--tw-scroll-snap-strictness)!important;
            --tw-scroll-snap-strictness: mandatory !important;
            -ms-overflow-style: none;
            scrollbar-width: none;
            scrollbar-width: none;
            justify-content: flex-start !important;
        }

        #tags-wrapper::-webkit-scrollbar {
            display: none;
        }
    }

    .section-banner-product input {
        color: #FFFFFF !important;
        border-color: #ffffff !important;
    }

    .section-banner-product input::placeholder {
        color: #FFFFFF !important;
    }

    .section-banner-product .input-new__button path {
        stroke: #FFFFFF !important;
    }
</style>

<div class="wrapper">
    <div class="mt-10 lg:mt-20 border-b border-solid border-[#e1e1df]">
        <h1 class="text-[32px] lg:text-[5.6rem] text-[#1C1C1C] mb-6 lg:mb-10 text-center">Learning Center</h1>
        {% if blog.tags.size > 0 %}
            <div class="flex justify-center items-center gap-6" id="tags-wrapper">
                <a href="{{ blog.url }}" class="block p-3 lg:p-5 text-[#1C1C1C] opacity-60 cursor-pointer whitespace-nowrap custom-blog-tag {% if request.path == blog.url or request.path == "/pages/blogs" %} active {% endif %}  ml-[15px] lg:ml-0">
                    All
                </a>
                {% for tag in blog.all_tags %}
                    {% assign lowerTag = tag | handleize %}
                    {% assign tag_url = blog.url | append: '/tagged/' | append: lowerTag %}
                    <a href="{{ blog.url }}/tagged/{{ tag | handleize }}" class="block p-3 lg:p-5 text-[#1C1C1C] opacity-60 cursor-pointer {% if request.path == tag_url %} active {% endif %} whitespace-nowrap custom-blog-tag {% if forloop.last %} mr-[15px] lg:mr-0{% endif %}">
                        {{ tag }}
                    </a>
                {% endfor %}
            </div>
        {% endif %}
        
    </div>
    <div class="page-width my-9 lg:my-14">
        {% render "custom-large-blog-card", article: blog.articles[0] %}

        {% unless blog.articles.size < 2 %}
        
        <div id="must-reads" class="my-14">
            <div class="pb-3 lg:pb-5 border-b border-[#e1e1df] border-solid">
                <h2 class="text-2xl lg:text-4xl text-[#1C1C1C]">Must reads</h2>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 my-6 lg:my-10">
                {% for article in blog.articles offset: 1 limit: 3 %}
                    {% render "custom-blog-card", article: article %}
                {% endfor %}
            </div>
        </div>

        {% endunless %}

        {% unless blog.articles.size < 4 %}

        <div class="flex flex-col lg:flex-row gap-4 pt-4 lg:pt-8">
            <div class="basis-2/3">
                <div class="pb-3 lg:pb-5 border-b border-[#e1e1df] border-solid">
                    <h2 class="text-2xl lg:text-4xl text-[#1C1C1C]">Recent posts</h2>
                </div>
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 gap-y-[56px] my-6 lg:my-10">
                    {% for article in blog.articles offset: 4 %}
                        {% if forloop.index == 3 %}
                            {% comment %} <div class="rounded-[24px] bg-[#E3F2F0] p-6 lg:p-8 flex flex-col gap-6 items-start justify-between">
                                <div class="flex gap-4 items-center">
                                    <div class="basis-1/3">
                                        <img src="https://cdn.shopify.com/s/files/1/0152/2181/7444/files/image_16.jpg?v=1697129087" alt="">
                                    </div>
                                    <div class="basis-2/3">
                                        <h3 class="mb-2.5 text-2xl text-[#1C1C1C]">Keep learning with our UTI e-book and education series!</h3>
                                        <p class="text-sm text-[#494948] font-normal">Get our FREE UTI e-book!</p>
                                    </div>
                                </div>
                                <div class="flex flex-col gap-8 w-full">
                                    {% form 'customer' %}
                                        <div class="flex flex-col gap-8 w-full">
                                            <div class="w-full">
                                                <label for="email" class="hidden">Email</label>
                                                <input type="email" name="contact[email]" placeholder="E-mail" class="text-[#1c1c1c] text-2xl border-b border-solid border-[#cbd8d7] font-normal w-full min-h-[70px]"/>
                                              </div>
                                            
                                              <div>
                                                <input type="submit" value="Get the UTI e-book" class="text-black bg-white py-4 px-8 border-none w-full rounded-full cursor-pointer" />
                                              </div>
                                        </div>

                                      {% endform %}
                                </div>
                            </div> {% endcomment %}
                            <div class="klaviyo-form-YhBAti"></div>
                        {% endif %}
                        {% render "custom-blog-card", article: article, index: forloop.index %}
                    {% endfor %}
                </div>
                <button class="px-6 py-3 bg-[#C33635] text-white min-w-[180px] mt-14 text-center rounded-full mx-auto block w-full lg:w-auto" id="show-more">Show more</button>
            </div>
            <div class="basis-1/3 pt-8 lg:pt-0 lg:pl-11">
                <div class="my-6 lg:my-0 flex flex-col gap-6 lg:gap-10 lg:sticky lg:top-[3rem]">
                    <div class="pb-3 lg:pb-5 border-b border-[#e1e1df] border-solid">
                        <h2 class="text-2xl lg:text-4xl text-[#1C1C1C]">Our best sellers</h2>
                    </div>
                    {% for product in collections.all.products limit: 3 %}
                    <a href="{{ product.url }}" class="flex gap-4">
                        <div class="basis-1/4">
                            <img class="rounded-[12px] max-h-[104px] aspect-square object-cover" src="{{ product.featured_image | img_url: "200x"}}" alt="">
                        </div>
                        <div class="flex flex-col gap-2 basis-3/4">
                            <h3 class="text-base text-[#1C1C1C] font-medium">{{ product.title }}</h3>
                            <p class="text-sm text-[#494948] font-normal">{% if product.description != blank %}{{ product.description | strip_html | truncatewords: 10, '...' }}{% else %}{{ product.metafields.bm_pdp.bm_short_description_details | strip_html | truncatewords: 10, '...' }}{% endif %}</p>
                        </div>
                    </a>
                    {% endfor %}
                </div>
            </div>
        </div>

        {% endunless %}
    </div>

    <div class="page-width">
        <div class="rounded-[24px] flex flex-col-reverse lg:flex-row gap-1.5 items-center my-6 lg:my-20 " style="background: linear-gradient(264deg, #0777A3 -4.31%, #1FA9B8 53.39%, #52B7AF 104.58%);">
            <div class="basis-1/2">
                <img src="https://cdn.shopify.com/s/files/1/0152/2181/7444/files/Rectangle_bd03a3e4-a72a-4e22-a365-608b0010c366.png?v=1697135471" alt="">
            </div>
            <div class="lg:pr-20 basis-1/2 px-6 mt-8 lg:px-0 lg:pt-0">
                <h3 class="lg:text-5xl text-white font-medium mb-3 lg:mb-5 text-2xl">Knowledge is power</h3>
                <p class="text-xl text-white font-normal">Sign up to our newsletter to keep learning!</p>
                <div class="flex flex-col gap-8 w-full section-banner-product mt-6 lg:mt-12">
                    {% render 'omnisend-form', section_id: section.id, snippet_context: 'section' %}
                </div>
            </div>
        </div>
    </div>
    
    {% unless blog.articles.size < 7 and request.path != blog.url %}
        {% assign video_exist = false %}
        {%- for video in blog.articles -%}
            {% if video.tags contains "video" %}
                {% assign video_exist = true %}
            {% endif %}
        {% endfor %}
            
    {% if video_exist == true %}
    <div class="page-width pt-5 lg:pt-0 pb-12">
        <div class="pb-3 lg:pb-5 border-b border-[#e1e1df] border-solid">
            <h2 class="text-2xl lg:text-4xl text-[#1C1C1C]">Latest videos</h2>
        </div>
        <div class="flex flex-col lg:flex-row gap-6 mt-5 lg:mt-10">
            {% assign check = 1 %}
            {%- for video in blog.articles -%}
                {% if video.tags contains "video" and check < 3 %}
                {% assign check = check | plus: 1 %}
                <a href="{{ video.url }}" class="flex-1 block">
                    <div class="relative">
                        <img class="rounded-[10px]" src="{{ video.image | img_url: "700x" }}" loading="lazy" alt="">
                        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2">
                            <svg width="56" height="56" viewBox="0 0 56 56" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <g filter="url(#filter0_b_2590_8239)">
                                <rect width="56" height="56" rx="28" fill="#1C1C1C" fill-opacity="0.4"/>
                                <path d="M22.1665 20.797C22.1665 19.3729 23.7419 18.5128 24.9399 19.2829L36.1445 26.4859C37.2467 27.1944 37.2467 28.8056 36.1445 29.5141L24.9399 36.7171C23.7419 37.4872 22.1665 36.6271 22.1665 35.203V20.797Z" fill="white"/>
                                </g>
                                <defs>
                                <filter id="filter0_b_2590_8239" x="-40" y="-40" width="136" height="136" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                                <feFlood flood-opacity="0" result="BackgroundImageFix"/>
                                <feGaussianBlur in="BackgroundImageFix" stdDeviation="20"/>
                                <feComposite in2="SourceAlpha" operator="in" result="effect1_backgroundBlur_2590_8239"/>
                                <feBlend mode="normal" in="SourceGraphic" in2="effect1_backgroundBlur_2590_8239" result="shape"/>
                                </filter>
                                </defs>
                            </svg>                                
                        </div>
                    </div>
                    <h2 class="text-[22px] text-[#1C1C1C] mt-4">{{ video.title }}</h3>
                </a>
                {% endif %}
            {% endfor %}
        </div>
    </div>    
    {% endif %}
    {% endunless %}
</div>

{% unless blog.articles.size < 4 %}
<script defer>
    // Initialize an offset variable to start from the 6th card (index 5)
    let offset = 5;
    let isShowingAll = false;

    // Attach a click event listener to the "Show More" button
    const showMoreBtn = document.querySelector('#show-more');

    showMoreBtn.addEventListener('click', function() {
    
    // Get all custom blog cards
    const blogCards = document.querySelectorAll('.custom-blog-card');

    if (!isShowingAll) {
        let endOffset = offset + 5;

        // Loop through the blog cards in the specified offset range
        for (let i = offset; i < endOffset; i++) {
        // If we reached the end of the list, stop the loop
        if (i >= blogCards.length) {
            endOffset = i;
            break;
        }

        // Remove the "hidden" class from the blog card to make it visible
        blogCards[i].classList.remove('hidden');
        }

        // Update the offset for the next batch of cards
        offset = endOffset;

        // If all cards are visible, change the button text to 'Show Less'
        if (offset >= blogCards.length) {
        showMoreBtn.textContent = 'Show Less';
        isShowingAll = true;
        }
    } else {
        // Revert to 'Show More' state
        isShowingAll = false;
        showMoreBtn.textContent = 'Show More';

        // Hide the last 5 cards (or however many are left)
        for (let i = offset - 1; i >= offset - 5 && i >= 0; i--) {
        blogCards[i].classList.add('hidden');
        }

        // Update the offset
        offset = Math.max(5, offset - 5);
    }
    });
</script>
{% endunless %}

{% schema %}
{
  "name": "Custom Main Blogs",
  "class": "custom-main-blogs",
  "tag": "section",
  "settings": [
    
  ]
}
{% endschema %}